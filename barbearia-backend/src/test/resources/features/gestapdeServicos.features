Feature: Gestão de Serviços

# ------------------------- Serviço deve ser criado com nome, duração e preço -------------------------
    Scenario: Criar um novo serviço com todas as informações obrigatórias
        Given que sou um administrador na tela de criação de serviços
        When eu preencho o nome "Corte Masculino", duração "30" e preço "50.00"
        Then o serviço é criado com sucesso
        And o serviço "Corte Masculino" aparece na lista de serviços

    Scenario: Impedir criação de serviço sem um nome
        Given que sou um administrador na tela de criação de serviços
        When eu tento criar um serviço com duração "30" e preço "50.00", mas sem nome
        Then o sistema rejeita a operação
        And exibe a mensagem de erro "O campo 'nome' é obrigatório."

# ------------------------- O nome de um serviço deve ser único -------------------------
    Scenario: Criar um serviço com um nome que ainda não existe
        Given que não existe um serviço chamado "Barba Desenhada"
        When eu crio um novo serviço com o nome "Barba Desenhada"
        Then o serviço é criado com sucesso

    Scenario: Impedir criação de serviço com nome duplicado
        Given que já existe um serviço chamado "Corte Masculino"
        When eu tento criar um novo serviço com o nome "Corte Masculino"
        Then o sistema rejeita a operação
        And exibe a mensagem de erro "Já existe um serviço com este nome."

# ------------------------- Duração e preço devem ser valores positivos -------------------------
    Scenario: Criar um serviço com duração e preço positivos
        Given que estou criando um novo serviço
        When eu informo a duração "45" e o preço "60.00"
        Then o serviço é criado com sucesso

    Scenario: Impedir criação de serviço com preço negativo
        Given que estou criando um novo serviço
        When eu informo a duração "45" e o preço "-60.00"
        Then o sistema rejeita a operação
        And exibe a mensagem de erro "O preço deve ser um valor positivo."

# ------------------------- Administrador deve poder visualizar a lista de serviços -------------------------
    Scenario: Visualizar a lista de todos os serviços cadastrados
        Given que existem os serviços "Corte Masculino" e "Barba Simples" cadastrados
        When eu acesso a tela de "Gestão de Serviços"
        Then a lista de serviços deve exibir "Corte Masculino"
        And a lista de serviços deve exibir "Barba Simples"

    Scenario: Visualizar uma mensagem quando não há serviços cadastrados
        Given que não existe nenhum serviço cadastrado no sistema
        When eu acesso a tela de "Gestão de Serviços"
        Then o sistema deve exibir a mensagem "Nenhum serviço cadastrado."

# ------------------------- Administrador deve poder editar um serviço -------------------------
    Scenario: Editar o preço de um serviço existente
        Given que existe o serviço "Corte Masculino" com preço "50.00"
        When eu edito o serviço e altero o preço para "55.00"
        Then a alteração é salva com sucesso
        And o novo preço do "Corte Masculino" é "55.00"

    Scenario: Falha ao tentar editar um serviço que não existe
        Given que não existe um serviço com o ID "serv-999"
        When eu tento submeter uma alteração de preço para o serviço com ID "serv-999"
        Then o sistema rejeita a operação
        And exibe a mensagem de erro "Serviço não encontrado."

# ------------------------- Um serviço pode ser temporariamente desativado -------------------------
    Scenario: Desativar um serviço ativo
        Given que o serviço "Pintura de Cabelo" está com status "Ativo"
        When eu solicito a desativação do serviço
        Then o status do serviço "Pintura de Cabelo" é alterado para "Inativo"

    Scenario: Impedir desativação de um serviço já inativo
        Given que o serviço "Pintura de Cabelo" já está com status "Inativo"
        When eu tento desativá-lo novamente
        Then o sistema informa que a ação não pode ser concluída
        And exibe a mensagem "Este serviço já está inativo."

# ------------------------- Serviço inativo não é exibido para clientes -------------------------
    Scenario: Serviço ativo é exibido na lista para agendamento
        Given que o serviço "Hidratação" está com status "Ativo"
        When um cliente acessa a tela de agendamento
        Then o serviço "Hidratação" é exibido como uma opção

    Scenario: Serviço inativo não é exibido na lista para agendamento
        Given que o serviço "Pintura de Cabelo" está com status "Inativo"
        When um cliente acessa a tela de agendamento
        Then o serviço "Pintura de Cabelo" não é exibido como uma opção

# ------------------------- Um serviço inativo pode ser reativado -------------------------
    Scenario: Reativar um serviço inativo
        Given que o serviço "Pintura de Cabelo" está com status "Inativo"
        When eu solicito a reativação do serviço
        Then o status do serviço "Pintura de Cabelo" é alterado para "Ativo"

    Scenario: Impedir reativação de um serviço já ativo
        Given que o serviço "Hidratação" já está com status "Ativo"
        When eu tento reativá-lo novamente
        Then o sistema informa que a ação não pode ser concluída
        And exibe a mensagem "Este serviço já está ativo."

# ------------------------- Um serviço pode ser removido permanentemente -------------------------
    Scenario: Remover permanentemente um serviço sem agendamentos futuros
        Given que o serviço "Massagem Capilar" não possui agendamentos futuros
        When eu solicito a remoção permanente do serviço
        Then o serviço "Massagem Capilar" é removido com sucesso
        And ele não aparece mais na lista geral de serviços

    Scenario: Tentar remover um serviço que não existe
        Given que não existe um serviço com o ID "serv-999"
        When eu tento remover permanentemente o serviço com ID "serv-999"
        Then o sistema rejeita a operação
        And exibe a mensagem de erro "Serviço não encontrado."

# ------------------------- Impedir remoção de serviço com agendamentos futuros -------------------------
    Scenario: Permitir remoção de serviço sem agendamentos futuros
        Given que o serviço "Corte Infantil" não tem agendamentos futuros
        When eu solicito a remoção permanente do serviço
        Then a operação é concluída com sucesso

    Scenario: Impedir remoção de serviço com agendamentos futuros
        Given que o serviço "Corte Masculino" possui 2 agendamentos para amanhã
        When eu tento remover permanentemente o serviço
        Then o sistema rejeita a operação
        And exibe a mensagem: "Este serviço não pode ser removido pois possui agendamentos futuros."

# ------------------------- Associar serviço a profissionais qualificados -------------------------
    Scenario: Associar um serviço a múltiplos profissionais
        Given que existe o serviço "Barba Desenhada"
        And existem os profissionais "João Barbeiro" e "Pedro Barbeiro"
        When eu associo o serviço "Barba Desenhada" a "João Barbeiro" e "Pedro Barbeiro"
        Then a associação é salva com sucesso

    Scenario: Desassociar um profissional de um serviço
        Given que "João Barbeiro" está associado ao serviço "Barba Desenhada"
        When eu removo a associação de "João Barbeiro" com este serviço
        Then a associação é removida com sucesso

# ------------------------- Cliente só pode agendar com profissional qualificado -------------------------
    Scenario: Cliente agenda serviço com profissional qualificado
        Given que "Pedro Barbeiro" está habilitado para o serviço "Barba Desenhada"
        When um cliente tenta agendar "Barba Desenhada" com "Pedro Barbeiro"
        Then o sistema permite o agendamento

    Scenario: Cliente é impedido de agendar com profissional não qualificado
        Given que "Maria Estilista" não está habilitada para o serviço "Barba Desenhada"
        When um cliente tenta agendar "Barba Desenhada" com "Maria Estilista"
        Then o sistema não exibe "Maria Estilista" como opção para este serviço

# ------------------------- Serviço pode ter tempo de intervalo/limpeza -------------------------
    Scenario: Definir um tempo de limpeza para um serviço
        Given que existe o serviço "Coloração"
        When eu defino um tempo de limpeza de "15" minutos para este serviço
        Then a configuração é salva com sucesso

    Scenario: Tentar definir um tempo de limpeza com valor não numérico
        Given que existe o serviço "Coloração"
        When eu tento definir um tempo de limpeza com o valor "quinze minutos"
        Then o sistema rejeita a operação
        And exibe a mensagem "O valor para tempo de limpeza deve ser um número inteiro."

# ------------------------- Tempo total bloqueado na agenda = duração + intervalo -------------------------
    Scenario: Verificar bloqueio total na agenda incluindo tempo de limpeza
        Given o serviço "Coloração" tem duração de 90 minutos
        And tem um tempo de limpeza configurado de 15 minutos
        When um cliente agenda "Coloração" para às 14:00
        Then a agenda do profissional deve ficar bloqueada das 14:00 até às 15:45

    Scenario: Verificar bloqueio na agenda para serviço sem tempo de limpeza
        Given o serviço "Corte Masculino" tem duração de 30 minutos
        And não tem tempo de limpeza configurado
        When um cliente agenda "Corte Masculino" para às 10:00
        Then a agenda do profissional deve ficar bloqueada das 10:00 até às 10:30

# ------------------------- Serviços podem ser organizados em categorias -------------------------
    Scenario: Atribuir um serviço a uma categoria existente
        Given que existe a categoria "Barba & Bigode"
        And existe o serviço "Barboterapia"
        When eu atribuo o serviço "Barboterapia" à categoria "Barba & Bigode"
        Then a associação é salva com sucesso

    Scenario: Remover um serviço de uma categoria
        Given que o serviço "Barboterapia" está na categoria "Barba & Bigode"
        When eu removo o serviço desta categoria
        Then a associação é desfeita com sucesso

# ------------------------- Serviço pode ser marcado com destaques -------------------------
    Scenario: Marcar um serviço como "Popular"
        Given que o serviço "Corte Degradê" não tem destaques
        When eu marco o serviço como "Popular"
        Then o destaque é aplicado com sucesso

    Scenario: Remover o destaque de um serviço
        Given que o serviço "Corte Degradê" está marcado como "Popular"
        When eu removo o destaque "Popular"
        Then o destaque é removido com sucesso

# ------------------------- Serviço pode ter uma imagem associada -------------------------
    Scenario: Associar uma URL de imagem válida a um serviço
        Given que existe o serviço "Penteado de Festa"
        When eu associo a URL de imagem "http://example.com/penteado.jpg" ao serviço
        Then a imagem é associada com sucesso

    Scenario: Tentar associar uma URL de imagem com formato inválido
        Given que existe o serviço "Penteado de Festa"
        When eu tento associar a URL "texto-invalido" ao serviço
        Then o sistema rejeita a operação
        And exibe a mensagem "Formato de URL inválido."

# ------------------------- Serviço pode ser definido como "add-on" -------------------------
    Scenario: Cliente adiciona um serviço "add-on" a um serviço principal
        Given que "Hidratação Rápida" é um serviço "add-on" do serviço "Corte Feminino"
        When um cliente seleciona "Corte Feminino" para agendamento
        Then o sistema oferece a opção de adicionar "Hidratação Rápida" ao mesmo agendamento

    Scenario: Impedir que um serviço "add-on" seja agendado sozinho
        Given que "Hidratação Rápida" é um serviço "add-on"
        When um cliente tenta agendar apenas o serviço "Hidratação Rápida"
        Then o sistema não permite a operação
        And exibe a mensagem "Este serviço só pode ser agendado junto com outro serviço principal."